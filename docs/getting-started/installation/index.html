<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.75.1"><link rel=alternate type=application/rss+xml href=https://azure.github.io/secrets-store-csi-driver-provider-azure/docs/getting-started/installation/index.xml><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel="shortcut icon" href=/secrets-store-csi-driver-provider-azure/docs/favicons/favicon.ico><link rel=apple-touch-icon href=/secrets-store-csi-driver-provider-azure/docs/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/secrets-store-csi-driver-provider-azure/docs/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/secrets-store-csi-driver-provider-azure/docs/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/secrets-store-csi-driver-provider-azure/docs/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/secrets-store-csi-driver-provider-azure/docs/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/secrets-store-csi-driver-provider-azure/docs/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/secrets-store-csi-driver-provider-azure/docs/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/secrets-store-csi-driver-provider-azure/docs/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/secrets-store-csi-driver-provider-azure/docs/favicons/android-192x192.png sizes=192x192><title>Installation | Azure Key Vault Provider for Secrets Store CSI Driver</title><meta property="og:title" content="Installation"><meta property="og:description" content="How to install Secrets Store CSI Driver and Azure Key Vault Provider on your clusters."><meta property="og:type" content="website"><meta property="og:url" content="https://azure.github.io/secrets-store-csi-driver-provider-azure/docs/getting-started/installation/"><meta property="og:site_name" content="Azure Key Vault Provider for Secrets Store CSI Driver"><meta itemprop=name content="Installation"><meta itemprop=description content="How to install Secrets Store CSI Driver and Azure Key Vault Provider on your clusters."><meta name=twitter:card content="summary"><meta name=twitter:title content="Installation"><meta name=twitter:description content="How to install Secrets Store CSI Driver and Azure Key Vault Provider on your clusters."><link rel=preload href=/secrets-store-csi-driver-provider-azure/docs/scss/main.min.4ca46c7779e12beaabf98a54574d3cfc6e8be930d2014b43de9cc43dac12f2e0.css as=style><link href=/secrets-store-csi-driver-provider-azure/docs/scss/main.min.4ca46c7779e12beaabf98a54574d3cfc6e8be930d2014b43de9cc43dac12f2e0.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/secrets-store-csi-driver-provider-azure/docs/><span class=navbar-logo></span><span class="text-uppercase font-weight-bold">Azure Key Vault Provider for Secrets Store CSI Driver</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/secrets-store-csi-driver-provider-azure/docs/><span class=active>Documentation</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/secrets-store-csi-driver-provider-azure/docs/offline-search-index.b5f7bbcf3481f0d3f934d602b58cdc63.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><div id=content-mobile><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/secrets-store-csi-driver-provider-azure/docs/offline-search-index.b5f7bbcf3481f0d3f934d602b58cdc63.json data-offline-search-base-href=/ data-offline-search-max-results=10>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form></div><div id=content-desktop></div><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/secrets-store-csi-driver-provider-azure/docs/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Documentation</a></li><ul><li class="collapse show" id=secrets-store-csi-driver-provider-azuredocs><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/secrets-store-csi-driver-provider-azure/docs/getting-started/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Getting Started</a></li><ul><li class="collapse show" id=secrets-store-csi-driver-provider-azuredocsgetting-started><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/secrets-store-csi-driver-provider-azure/docs/getting-started/installation/ class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Installation</a></li><ul><li class="collapse show" id=secrets-store-csi-driver-provider-azuredocsgetting-startedinstallation></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/secrets-store-csi-driver-provider-azure/docs/getting-started/usage/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Using the Azure Key Vault Provider</a></li><ul><li class=collapse id=secrets-store-csi-driver-provider-azuredocsgetting-startedusage></li></ul></ul></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/secrets-store-csi-driver-provider-azure/docs/demos/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Demos</a></li><ul><li class=collapse id=secrets-store-csi-driver-provider-azuredocsdemos><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/secrets-store-csi-driver-provider-azure/docs/demos/standard-walkthrough/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Standard Walkthrough</a></li><ul><li class=collapse id=secrets-store-csi-driver-provider-azuredocsdemosstandard-walkthrough></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/secrets-store-csi-driver-provider-azure/docs/demos/community-demos-and-presentations/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Community Demos and Presentations</a></li><ul><li class=collapse id=secrets-store-csi-driver-provider-azuredocsdemoscommunity-demos-and-presentations><a class="td-sidebar-link td-sidebar-link__page" id=m-secrets-store-csi-driver-provider-azuredocsdemoscommunity-demos-and-presentationshoussem-dellai href=/secrets-store-csi-driver-provider-azure/docs/demos/community-demos-and-presentations/houssem-dellai/>Houssem Dellai - Retrieving database login info from Azure KeyVault</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-secrets-store-csi-driver-provider-azuredocsdemoscommunity-demos-and-presentationshoussem-dellai-workload-identity href=/secrets-store-csi-driver-provider-azure/docs/demos/community-demos-and-presentations/houssem-dellai-workload-identity/>Houssem Dellai - Retrieving database login info from Azure KeyVault using Workload Identity</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-secrets-store-csi-driver-provider-azuredocsdemoscommunity-demos-and-presentationsnilesh-gule href=/secrets-store-csi-driver-provider-azure/docs/demos/community-demos-and-presentations/nilesh-gule/>Nilesh Gule - Retrieving RabbitMQ related secret from Azure KeyVault</a></li></ul></ul></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/secrets-store-csi-driver-provider-azure/docs/configurations/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Configurations</a></li><ul><li class=collapse id=secrets-store-csi-driver-provider-azuredocsconfigurations><a class="td-sidebar-link td-sidebar-link__page" id=m-secrets-store-csi-driver-provider-azuredocsconfigurationsfeature-flags href=/secrets-store-csi-driver-provider-azure/docs/configurations/feature-flags/>Feature Flags</a><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/secrets-store-csi-driver-provider-azure/docs/configurations/identity-access-modes/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Identity Access Modes</a></li><ul><li class=collapse id=secrets-store-csi-driver-provider-azuredocsconfigurationsidentity-access-modes><a class="td-sidebar-link td-sidebar-link__page" id=m-secrets-store-csi-driver-provider-azuredocsconfigurationsidentity-access-modesworkload-identity-mode href=/secrets-store-csi-driver-provider-azure/docs/configurations/identity-access-modes/workload-identity-mode/>Workload Identity</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-secrets-store-csi-driver-provider-azuredocsconfigurationsidentity-access-modessystem-assigned-msi-mode href=/secrets-store-csi-driver-provider-azure/docs/configurations/identity-access-modes/system-assigned-msi-mode/>System-assigned Managed Identity</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-secrets-store-csi-driver-provider-azuredocsconfigurationsidentity-access-modesuser-assigned-msi-mode href=/secrets-store-csi-driver-provider-azure/docs/configurations/identity-access-modes/user-assigned-msi-mode/>User-assigned Managed Identity</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-secrets-store-csi-driver-provider-azuredocsconfigurationsidentity-access-modesservice-principal-mode href=/secrets-store-csi-driver-provider-azure/docs/configurations/identity-access-modes/service-principal-mode/>Service Principal</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-secrets-store-csi-driver-provider-azuredocsconfigurationsidentity-access-modespod-identity-mode href=/secrets-store-csi-driver-provider-azure/docs/configurations/identity-access-modes/pod-identity-mode/>Pod Identity</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-secrets-store-csi-driver-provider-azuredocsconfigurationsmetrics href=/secrets-store-csi-driver-provider-azure/docs/configurations/metrics/>Metrics</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-secrets-store-csi-driver-provider-azuredocsconfigurationssync-with-k8s-secrets href=/secrets-store-csi-driver-provider-azure/docs/configurations/sync-with-k8s-secrets/>Sync Mounted Content with Kubernetes Secret</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-secrets-store-csi-driver-provider-azuredocsconfigurationssync-multiple-versions href=/secrets-store-csi-driver-provider-azure/docs/configurations/sync-multiple-versions/>Sync Multiple Versions of a Secret</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-secrets-store-csi-driver-provider-azuredocsconfigurationsenable-auto-rotation-secrets href=/secrets-store-csi-driver-provider-azure/docs/configurations/enable-auto-rotation-secrets/>Enable Auto Rotation of Secrets</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-secrets-store-csi-driver-provider-azuredocsconfigurationsset-env-var href=/secrets-store-csi-driver-provider-azure/docs/configurations/set-env-var/>Set your Environment Variable to Reference a Kubernetes Secret</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-secrets-store-csi-driver-provider-azuredocsconfigurationsingress-tls href=/secrets-store-csi-driver-provider-azure/docs/configurations/ingress-tls/>Enable NGINX Ingress Controller with TLS</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-secrets-store-csi-driver-provider-azuredocsconfigurationscustom-environments href=/secrets-store-csi-driver-provider-azure/docs/configurations/custom-environments/>Custom Azure Environments</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-secrets-store-csi-driver-provider-azuredocsconfigurationsgetting-certs-and-keys href=/secrets-store-csi-driver-provider-azure/docs/configurations/getting-certs-and-keys/>Getting Certificates and Keys using Azure Key Vault Provider</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-secrets-store-csi-driver-provider-azuredocsconfigurationsdeploy-in-openshift href=/secrets-store-csi-driver-provider-azure/docs/configurations/deploy-in-openshift/>Setup Secrets Store CSI Driver on Azure RedHat OpenShift (ARO)</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/secrets-store-csi-driver-provider-azure/docs/troubleshooting/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Troubleshooting</a></li><ul><li class=collapse id=secrets-store-csi-driver-provider-azuredocstroubleshooting></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/secrets-store-csi-driver-provider-azure/docs/upgrading/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Upgrading</a></li><ul><li class=collapse id=secrets-store-csi-driver-provider-azuredocsupgrading></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/secrets-store-csi-driver-provider-azure/docs/support/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Support</a></li><ul><li class=collapse id=secrets-store-csi-driver-provider-azuredocssupport></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/secrets-store-csi-driver-provider-azure/docs/contribution-guidelines/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Contribution Guidelines</a></li><ul><li class=collapse id=secrets-store-csi-driver-provider-azuredocscontribution-guidelines></li></ul></ul></li></ul></ul></nav></div></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/Azure/secrets-store-csi-driver-provider-azure/edit/master/content/en/getting-started/installation/_index.md target=_blank><i class="fa fa-edit fa-fw"></i>Edit this page</a>
<a href="https://github.com/Azure/secrets-store-csi-driver-provider-azure/new/master/content/en/getting-started/installation/_index.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" target=_blank><i class="fa fa-edit fa-fw"></i>Create child page</a>
<a href="https://github.com/Azure/secrets-store-csi-driver-provider-azure/issues/new?title=Installation" target=_blank><i class="fab fa-github fa-fw"></i>Create documentation issue</a>
<a href="https://github.com/Azure/secrets-store-csi-driver-provider-azure/issues/new?assignees=&labels=bug&template=bug-report.md&title=/issues/new" target=_blank><i class="fas fa-tasks fa-fw"></i>Create project issue</a></div><nav id=TableOfContents><ul><li><ul><li><a href=#install-the-secrets-store-csi-driver-and-the-azure-keyvault-provider>Install the Secrets Store CSI Driver and the Azure Keyvault Provider</a></li><li><a href=#uninstall>Uninstall</a></li></ul></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=https://azure.github.io/secrets-store-csi-driver-provider-azure/docs/getting-started/>Getting Started</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://azure.github.io/secrets-store-csi-driver-provider-azure/docs/getting-started/installation/>Installation</a></li></ol></nav><div class=td-content><h1>Installation</h1><div class=lead>How to install Secrets Store CSI Driver and Azure Key Vault Provider on your clusters.</div><h3 id=install-the-secrets-store-csi-driver-and-the-azure-keyvault-provider>Install the Secrets Store CSI Driver and the Azure Keyvault Provider</h3><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>The helm chart repository URL has changed to <code>https://azure.github.io/secrets-store-csi-driver-provider-azure/charts</code></div><h4 id=prerequisites>Prerequisites</h4><p>Recommended Kubernetes version:</p><ul><li>For Linux - v1.16.0+</li><li>For Windows - v1.18.0+</li></ul><blockquote><p>For Kubernetes version 1.15 and below, please use <a href=https://github.com/Azure/kubernetes-keyvault-flexvol>Azure Keyvault Flexvolume</a></p></blockquote><h4 id=deployment-using-helm>Deployment using Helm</h4><p>Azure Key Vault Provider for Secrets Store CSI Driver allows users to customize their installation via Helm.</p><blockquote><p>Recommended to use Helm3</p></blockquote><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>helm repo add csi-secrets-store-provider-azure https://azure.github.io/secrets-store-csi-driver-provider-azure/charts
helm install csi csi-secrets-store-provider-azure/csi-secrets-store-provider-azure
</code></pre></div><blockquote><p>Important: It&rsquo;s recommended to install the Azure Key Vault Provider for Secrets Store CSI Driver in the <code>kube-system</code> namespace using Helm.</p></blockquote><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>helm install csi csi-secrets-store-provider-azure/csi-secrets-store-provider-azure --namespace kube-system
</code></pre></div><div class="alert alert-warning" role=alert><h4 class=alert-heading>Why kube-system</h4><ol><li>The driver and provider are installed as a <em>DaemonSet</em> with the ability to mount kubelet hostPath volumes and view pod service account tokens. It should be treated as privileged and regular cluster users should not have permissions to deploy or modify the driver.</li><li>For AKS clusters with <a href=https://docs.microsoft.com/en-us/azure/aks/limit-egress-traffic>limited egress traffic</a>, installing the driver and provider in <code>kube-system</code> is required to be able to establish connectivity to the <code>kube-apiserver</code>. Refer to <a href=https://github.com/Azure/secrets-store-csi-driver-provider-azure/issues/488>#488</a> for more details.</li><li>The driver pods need to run as root to mount the volume as tmpfs in the pod. Deploying the driver and provider in <code>kube-system</code> will prevent <a href=https://docs.microsoft.com/en-us/azure/security-center/container-security>ASC</a> from generating alert &ldquo;Running containers as root user should be avoided&rdquo;. Refer to <a href=https://github.com/Azure/secrets-store-csi-driver-provider-azure/issues/327>#327</a> for more details.</li></ol></div><p>The helm charts hosted in <a href=https://github.com/Azure/secrets-store-csi-driver-provider-azure/tree/master/charts/csi-secrets-store-provider-azure>Azure/secrets-store-csi-driver-provider-azure</a> repo include the Secrets Store CSI Driver helm charts as a dependency. Running the above <code>helm install</code> command will install both the Secrets Store CSI Driver and Azure Key Vault provider.</p><blockquote><p>Refer to <a href=../../configurations/deploy-in-openshift>doc</a> for installing the Azure Key Vault Provider for Secrets Store CSI Driver on Azure RedHat OpenShift (ARO)</p></blockquote><h5 id=values>Values</h5><p>For a list of customizable values that can be injected when invoking helm install, please see the <a href=https://github.com/Azure/secrets-store-csi-driver-provider-azure/blob/master/charts/csi-secrets-store-provider-azure/README.md#configuration>Helm chart configurations</a>.</p><h4 id=using-deployment-yamls>Using Deployment yamls</h4><ol><li><p><strong>Install the Secrets Store CSI Driver</strong></p><p>💡 Follow the <a href=https://secrets-store-csi-driver.sigs.k8s.io/getting-started/installation.html>Installation guide for the Secrets Store CSI Driver</a> to install the driver.</p><details><summary>Result</summary><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>csidriver.storage.k8s.io/secrets-store.csi.k8s.io created
serviceaccount/secrets-store-csi-driver created
clusterrole.rbac.authorization.k8s.io/secretproviderclasses-role created
clusterrolebinding.rbac.authorization.k8s.io/secretproviderclasses-rolebinding created
clusterrole.rbac.authorization.k8s.io/secretprovidersyncing-role created
clusterrolebinding.rbac.authorization.k8s.io/secretprovidersyncing-rolebinding created
daemonset.apps/csi-secrets-store-windows created
daemonset.apps/csi-secrets-store created
customresourcedefinition.apiextensions.k8s.io/secretproviderclasses.secrets-store.csi.x-k8s.io created
customresourcedefinition.apiextensions.k8s.io/secretproviderclasspodstatuses.secrets-store.csi.x-k8s.io created
</code></pre></div></details><br><p>To validate the driver is running as expected, run the following command:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl get pods -l <span style=color:#000>app</span><span style=color:#ce5c00;font-weight:700>=</span>csi-secrets-store -n kube-system
</code></pre></div><p>You should see the driver pods running on each agent node:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>NAME                      READY   STATUS    RESTARTS   AGE
csi-secrets-store-bp4f4   3/3     Running   <span style=color:#0000cf;font-weight:700>0</span>          24s
</code></pre></div></li><li><p><strong>Install the Azure Key Vault provider</strong></p><p>For linux nodes</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl apply -f https://raw.githubusercontent.com/Azure/secrets-store-csi-driver-provider-azure/master/deployment/provider-azure-installer.yaml
</code></pre></div><p>For windows nodes</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl apply -f https://raw.githubusercontent.com/Azure/secrets-store-csi-driver-provider-azure/master/deployment/provider-azure-installer-windows.yaml
</code></pre></div><p><strong>NOTE</strong>: Installing the provider using the deployment yamls from master will always install the latest version. If you want to deploy a specific version of the provider use the tagged release yamls.</p><p>To validate the provider&rsquo;s installer is running as expected, run the following commands:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl get pods -l <span style=color:#000>app</span><span style=color:#ce5c00;font-weight:700>=</span>csi-secrets-store-provider-azure
</code></pre></div><p>You should see the provider pods running on each agent node:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>NAME                                     READY   STATUS    RESTARTS   AGE
csi-secrets-store-provider-azure-4ngf4   1/1     Running   <span style=color:#0000cf;font-weight:700>0</span>          8s
csi-secrets-store-provider-azure-bxr5k   1/1     Running   <span style=color:#0000cf;font-weight:700>0</span>          8s
</code></pre></div></li></ol><p><strong>In addition, if you are using Secrets Store CSI Driver and the Azure Keyvault Provider in a cluster with <a href=https://kubernetes.io/docs/concepts/policy/pod-security-policy/>pod security policy</a> enabled</strong>, review and create the following policy that enables the spec required for Secrets Store CSI Driver and the Azure Keyvault Provider to work:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl apply -f https://raw.githubusercontent.com/Azure/secrets-store-csi-driver-provider-azure/master/deployment/pod-security-policy.yaml
</code></pre></div><h3 id=uninstall>Uninstall</h3><h4 id=using-helm>Using Helm</h4><p>If you deployed the Secrets Store CSI Driver and Azure Key Vault provider using the helm charts from <a href=https://github.com/Azure/secrets-store-csi-driver-provider-azure/tree/master/charts/csi-secrets-store-provider-azure>Azure/secrets-store-csi-driver-provider-azure</a>, then run the following command to uninstall:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>helm delete &lt;release name&gt;
</code></pre></div><blockquote><p>Refer to <a href=../../configurations/deploy-in-openshift>doc</a> to uninstall the Azure Key Vault Provider for Secrets Store CSI Driver on Azure RedHat OpenShift (ARO)</p></blockquote><h5 id=using-deployment-yamls-1>Using deployment yamls</h5><p>If the driver and provider were installed using deployment yamls, then you can delete all the components with the following commands:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#8f5902;font-style:italic># To delete AKV provider pods from Linux nodes</span>
kubectl delete -f https://raw.githubusercontent.com/Azure/secrets-store-csi-driver-provider-azure/master/deployment/provider-azure-installer.yaml

<span style=color:#8f5902;font-style:italic># To delete AKV provider pods from Windows nodes</span>
kubectl delete -f https://raw.githubusercontent.com/Azure/secrets-store-csi-driver-provider-azure/master/deployment/provider-azure-installer-windows.yaml
</code></pre></div><p>Delete the Secrets Store CSI Driver by running <code>kubectl delete</code> with all the manifests in <a href=https://github.com/kubernetes-sigs/secrets-store-csi-driver/tree/master/deploy>here</a>. If the Secrets Store CSI Driver was installed using the helm charts hosted in <a href=https://github.com/kubernetes-sigs/secrets-store-csi-driver/tree/master/charts/secrets-store-csi-driver>kubernetes-sigs/secrets-store-csi-driver</a>, then run the following command to delete the driver components:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>helm delete &lt;release name&gt;
</code></pre></div><div class=section-index><hr class=panel-line></div><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="feedback--answer feedback--answer-yes">Yes</button>
<button class="feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes">Glad to hear it! Please <a href=https://github.com/Azure/secrets-store-csi-driver-provider-azure/issues/new>tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no">Sorry to hear that. Please <a href=https://github.com/Azure/secrets-store-csi-driver-provider-azure/issues/new>tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector('.feedback--answer-yes');const noButton=document.querySelector('.feedback--answer-no');const yesResponse=document.querySelector('.feedback--response-yes');const noResponse=document.querySelector('.feedback--response-no');const disableButtons=()=>{yesButton.disabled=true;noButton.disabled=true;};const sendFeedback=(value)=>{if(typeof ga!=='function')return;const args={command:'send',hitType:'event',category:'Helpful',action:'click',label:window.location.pathname,value:value};ga(args.command,args.hitType,args.category,args.action,args.label,args.value);};yesButton.addEventListener('click',()=>{yesResponse.classList.add('feedback--response__visible');disableButtons();sendFeedback(1);});noButton.addEventListener('click',()=>{noResponse.classList.add('feedback--response__visible');disableButtons();sendFeedback(0);});</script><br><div class="text-muted mt-5 pt-3 border-top">Last modified February 1, 2022: <a href=https://github.com/Azure/secrets-store-csi-driver-provider-azure/commit/cf1f49b032b79ca7f7b776ca3eca1dec2875472f>docs: update chart repo to `https://azure.github.io/secrets-store-csi-driver-provider-azure/charts` (#784) (cf1f49b)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank rel="noopener noreferrer" href=https://kubernetes.slack.com/archives/C013PUP2WRK><i class="fab fa-slack"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel="noopener noreferrer" href=https://github.com/Azure/secrets-store-csi-driver-provider-azure><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 Azure Compute OSS Upstream Team All Rights Reserved</small></div></div></div></footer></div><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script><script src=/secrets-store-csi-driver-provider-azure/docs/js/main.min.f820bfc507c3ebefe17f8881ec4ee10013f3b89ad9555a50acf9bb1771e6823f.js integrity="sha256-+CC/xQfD6+/hf4iB7E7hABPzuJrZVVpQrPm7F3Hmgj8=" crossorigin=anonymous></script></body></html>